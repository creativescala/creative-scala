<!doctype html>
<html lang="">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Laika 0.19.0" />
    <title>Substitution</title>
    
    
    <meta name="description" content="book" />
    
    <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400|Source+Sans+Pro:300,400,600"
        rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Crimson+Pro:400" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="../creative-scala.css" />
    <script src="../solution.js"></script>
    <script src="../main.js"></script>
    <script> /* for avoiding page load transitions */</script>
</head>

<body>
    <nav id="topbar"><p><a href="index.html">←</a></p>
<p><a href="../../">Creative Scala: Form and Function</a></p>
<p><a href="order.html">→</a></p></nav>
    <nav id="sidebar">
        <ul class="nav-list">
          <li class="level1 nav-leaf"><a href="../">Creative Scala: Form and Function</a></li>
          <li class="level1 nav-leaf"><a href="../foreword-1.html">Foreword to the First Edition</a></li>
          <li class="level1 nav-leaf"><a href="../foreword-2.html">Foreword to the Second Edition</a></li>
          <li class="level1 nav-node"><a href="../setup/">Getting Started</a></li>
          <li class="level2 nav-leaf"><a href="../setup/background.html">Background</a></li>
          <li class="level2 nav-leaf"><a href="../setup/terminal.html">Installing Terminal Software and a Text Editor</a></li>
          <li class="level2 nav-leaf"><a href="../setup/github.html">GitHub</a></li>
          <li class="level2 nav-leaf"><a href="../setup/intellij.html">IntelliJ</a></li>
          <li class="level2 nav-leaf"><a href="../setup/">Setup</a></li>
          <li class="level1 nav-node"><a href="../expressions/">Expressions, Values, and Types</a></li>
          <li class="level2 nav-leaf"><a href="../expressions/02-starting.html">Starting to Program</a></li>
          <li class="level2 nav-leaf"><a href="../expressions/03-expressions.html">Expressions and Values</a></li>
          <li class="level2 nav-leaf"><a href="../expressions/04-types.html">Types</a></li>
          <li class="level2 nav-leaf"><a href="../expressions/05-exercises.html">Exercises</a></li>
          <li class="level2 nav-leaf"><a href="../expressions/06-summary.html">Summary</a></li>
          <li class="level1 nav-node"><a href="../expanding-expressions/">Expanding Expressions</a></li>
          <li class="level2 nav-leaf"><a href="../expanding-expressions/02-literals.html">Literal Expressions</a></li>
          <li class="level2 nav-leaf"><a href="../expanding-expressions/03-objects.html">Values are Objects</a></li>
          <li class="level2 nav-leaf"><a href="../expanding-expressions/04-types.html">Types</a></li>
          <li class="level2 nav-leaf"><a href="../expanding-expressions/exercises.html">Exercises</a></li>
          <li class="level2 nav-leaf"><a href="../expanding-expressions/04-images.html">Images</a></li>
          <li class="level1 nav-node"><a href="../expressive-expressions/">Expressive Expressions</a></li>
          <li class="level2 nav-leaf"><a href="../expressive-expressions/02-layout.html">Layout</a></li>
          <li class="level2 nav-leaf"><a href="../expressive-expressions/03-color.html">Color</a></li>
          <li class="level2 nav-leaf"><a href="../expressive-expressions/04-creating-color.html">Creating Colors</a></li>
          <li class="level1 nav-node"><a href="index.html">The Substitution Model of Evaluation</a></li>
          <li class="level2 active nav-leaf"><a href="#">Substitution</a></li>
          <li class="level2 nav-leaf"><a href="order.html">Order of Evaluation</a></li>
          <li class="level2 nav-leaf"><a href="local-reasoning.html">Local Reasoning</a></li>
          <li class="level1 nav-node"><a href="../methods/">Methods without Madness</a></li>
          <li class="level2 nav-leaf"><a href="../methods/methods.html">Methods</a></li>
          <li class="level2 nav-leaf"><a href="../methods/syntax.html">Method Syntax</a></li>
          <li class="level2 nav-leaf"><a href="../methods/semantics.html">Method Semantics</a></li>
          <li class="level2 nav-leaf"><a href="../methods/writing-methods.html">Writing Methods</a></li>
          <li class="level2 nav-leaf"><a href="../methods/conclusions.html">Conclusions</a></li>
          <li class="level1 nav-node"><a href="../recursion/">Structural Recursion over the Natural Numbers</a></li>
          <li class="level2 nav-leaf"><a href="../recursion/boxes.html">A Line of Boxes</a></li>
          <li class="level2 nav-leaf"><a href="../recursion/natural-numbers.html">The Natural Numbers</a></li>
          <li class="level2 nav-leaf"><a href="../recursion/match.html">Match Expressions</a></li>
          <li class="level2 nav-leaf"><a href="../recursion/substitution.html">Reasoning about Recursion</a></li>
          <li class="level2 nav-leaf"><a href="../recursion/conclusions.html">Conclusions</a></li>
          <li class="level1 nav-node"><a href="../fractals/">Fractals</a></li>
          <li class="level2 nav-leaf"><a href="../fractals/fractals.html">The Chessboard</a></li>
          <li class="level2 nav-leaf"><a href="../fractals/nested-methods.html">Nested Methods</a></li>
          <li class="level2 nav-leaf"><a href="../fractals/auxillary-parameter.html">Auxiliary Parameters</a></li>
          <li class="level2 nav-leaf"><a href="../fractals/exercises.html">Exercises</a></li>
          <li class="level1 nav-node"><a href="../polygons/">Points, Paths, and Polygons</a></li>
          <li class="level2 nav-leaf"><a href="../polygons/02-polar.html">Polar Coordinates</a></li>
          <li class="level2 nav-leaf"><a href="../polygons/03-path.html">Paths</a></li>
          <li class="level2 nav-leaf"><a href="../polygons/04-creative.html">Going Further</a></li>
          <li class="level2 nav-leaf"><a href="../polygons/05-conclusions.html">Conclusions</a></li>
          <li class="level1 nav-node"><a href="../flowers/">Functions and Flowers</a></li>
          <li class="level2 nav-leaf"><a href="../flowers/functions.html">Functions as Abstractions</a></li>
          <li class="level2 nav-leaf"><a href="../flowers/fun.html">Fun with Functions</a></li>
          <li class="level2 nav-leaf"><a href="../flowers/parametric-curves.html">Parametric Curves</a></li>
          <li class="level2 nav-leaf"><a href="../flowers/flowers.html">Flowers and Other Curves</a></li>
          <li class="level2 nav-leaf"><a href="../flowers/exercises.html">Exercises</a></li>
          <li class="level2 nav-leaf"><a href="../flowers/conclusions.html">Conclusions</a></li>
          <li class="level1 nav-node"><a href="../cycles/">Cycles</a></li>
          <li class="level2 nav-leaf"><a href="../cycles/hof.html">Higher Order Methods and Functions</a></li>
          <li class="level1 nav-header">collections</li>
          <li class="level2 nav-leaf"><a href="../collections/create.html">Creating Sequences</a></li>
          <li class="level2 nav-leaf"><a href="../collections/take-home-points.html">Take Home Points</a></li>
          <li class="level2 nav-leaf"><a href="../collections/">Collections {#collections}</a></li>
          <li class="level2 nav-leaf"><a href="../collections/transform.html">Transforming Sequences</a></li>
          <li class="level2 nav-leaf"><a href="../collections/paths.html">Drawing Paths</a></li>
          <li class="level1 nav-header">programs</li>
          <li class="level2 nav-leaf"><a href="../programs/imports.html">Packages and Imports</a></li>
          <li class="level2 nav-leaf"><a href="../programs/outside-console.html">Coding Outside the Console</a></li>
          <li class="level2 nav-leaf"><a href="../programs/console.html">Working Within the Console</a></li>
          <li class="level2 nav-leaf"><a href="../programs/names.html">Names</a></li>
          <li class="level2 nav-leaf"><a href="../programs/">Writing Larger Programs</a></li>
          <li class="level2 nav-leaf"><a href="../programs/abstraction.html">Abstraction</a></li>
          <li class="level1 nav-header">generative</li>
          <li class="level2 nav-leaf"><a href="../generative/generative.html">Generative Art</a></li>
          <li class="level2 nav-leaf"><a href="../generative/random.html">Randomness without Effect</a></li>
          <li class="level2 nav-leaf"><a href="../generative/api.html">Exploring Random</a></li>
          <li class="level2 nav-leaf"><a href="../generative/exercises.html">Exercises</a></li>
          <li class="level2 nav-leaf"><a href="../generative/for.html">For Comprehensions</a></li>
          <li class="level2 nav-leaf"><a href="../generative/product.html">Combining Random Values</a></li>
          <li class="level2 nav-leaf"><a href="../generative/">Composition of Generative Art</a></li>
          <li class="level2 nav-leaf"><a href="../generative/flatmap.html">Combining Random Values</a></li>
          <li class="level1 nav-header">quickreference</li>
          <li class="level2 nav-leaf"><a href="../quickreference/">Syntax Quick Reference {#syntax-quick-reference}</a></li>
          <li class="level1 nav-leaf"><a href="../solutions.html">Solutions to Exercises {#solutions}</a></li>
          <li class="level1 nav-header">fp</li>
          <li class="level2 nav-leaf"><a href="../fp/recursion.html">Recursive Algorithms</a></li>
          <li class="level2 nav-leaf"><a href="../fp/take-home-points.html">Take Home Points</a></li>
          <li class="level2 nav-leaf"><a href="../fp/functions.html">Functions as Values</a></li>
          <li class="level2 nav-leaf"><a href="../fp/">(Functional) Programming</a></li>
          <li class="level1 nav-header">summary</li>
          <li class="level2 nav-leaf"><a href="../summary/">Summary</a></li>
          <li class="level1 nav-header">sequences</li>
          <li class="level2 nav-leaf"><a href="../sequences/lists.html">Working with Lists</a></li>
          <li class="level2 nav-leaf"><a href="../sequences/stars.html">My God, It&#39;s Full of Stars!</a></li>
          <li class="level2 nav-leaf"><a href="../sequences/">Shapes, Sequences, and Stars</a></li>
          <li class="level2 nav-leaf"><a href="../sequences/map.html">Transforming Sequences</a></li>
          <li class="level2 nav-leaf"><a href="../sequences/paths.html">Paths</a></li>
          <li class="level1 nav-header">animation</li>
          <li class="level2 nav-leaf"><a href="../animation/reactor.html">Reactors</a></li>
          <li class="level2 nav-leaf"><a href="../animation/easing.html">Easing Functions</a></li>
          <li class="level2 nav-leaf"><a href="../animation/">Animation and Fireworks</a></li>
          <li class="level1 nav-header">turtles</li>
          <li class="level2 nav-leaf"><a href="../turtles/branching.html">Branching Structures</a></li>
          <li class="level2 nav-leaf"><a href="../turtles/turtles.html">Controlling the Turtle</a></li>
          <li class="level2 nav-leaf"><a href="../turtles/exercises.html">Exercises</a></li>
          <li class="level2 nav-leaf"><a href="../turtles/">Turtle Algebra and Algebraic Data Types</a></li>
          <li class="level1 nav-leaf"><a href="../intro.html">Introduction</a></li>
          <li class="level1 nav-header">adt</li>
          <li class="level2 nav-leaf"><a href="../adt/adt.html">Algebraic Data Types</a></li>
          <li class="level2 nav-leaf"><a href="../adt/turtle.html">Build Your Own Turtle</a></li>
          <li class="level2 nav-leaf"><a href="../adt/">Algebraic Data Types To Call Our Own</a></li>
          <li class="level1 nav-header">data</li>
          <li class="level2 nav-leaf"><a href="../data/case-classes.html">Case Classes</a></li>
          <li class="level2 nav-leaf"><a href="../data/data.html">Data</a></li>
          <li class="level2 nav-leaf"><a href="../data/">Creating and Working With Data</a></li>
          <li class="level1 nav-header">declarations</li>
          <li class="level2 nav-leaf"><a href="../declarations/method-declarations.html">Method Declarations</a></li>
          <li class="level2 nav-leaf"><a href="../declarations/color-palette.html">Extended Exercise: Color Palettes</a></li>
          <li class="level2 nav-leaf"><a href="../declarations/take-home-points.html">Take Home Points</a></li>
          <li class="level2 nav-leaf"><a href="../declarations/value-declarations.html">Value Declarations</a></li>
          <li class="level2 nav-leaf"><a href="../declarations/">Declarations</a></li>
          <li class="level1 nav-leaf"><a href="../links.html">links.md</a></li>
        </ul>
    </nav>

    <div id="content">
        <main class="content">
            <h1 id="substitution" class="title">Substitution</h1>
            <p>Substitution says that wherever we see an expression we can replace it with the value it evaluates to. For example, where we see</p>
            <pre><code class="nohighlight"><span class="number-literal">1</span><span> + </span><span class="number-literal">1</span></code></pre>
            <p>we can replace it with <code>2</code>.
            This in turn means when we see a compound expression such as</p>
            <pre><code class="nohighlight"><span>(</span><span class="number-literal">1</span><span> + </span><span class="number-literal">1</span><span>) + (</span><span class="number-literal">1</span><span> + </span><span class="number-literal">1</span><span>)</span></code></pre>
            <p>we can substitute <code>2</code> for <code>1 + 1</code> giving</p>
            <pre><code class="nohighlight"><span class="number-literal">2</span><span> + </span><span class="number-literal">2</span></code></pre>
            <p>which evaluates to <code>4</code>.</p>
            <p>This type of reasoning is what we do in high school algebra when we simplify an expression.
            Naturally computer science has fancy words for this process.
            In addition to substitution, we can call this <em>reducing an expression</em>, or <em>equational reasoning</em>.</p>
            <p>Substitution gives us a way to reason about our programs, which is another
            way of saying &quot;working out what they do&quot;.
            We can apply substitution to just about any expression we&#39;ve seen so far.
            It&#39;s easier to use examples that work with numbers and strings, rather than images, here so we&#39;ll return to an example we saw in an earlier chapter:</p>
            <pre><code class="nohighlight"><span class="number-literal">1</span><span> + (</span><span class="string-literal">&quot;Moonage daydream&quot;</span><span>.</span><span class="identifier">indexOf</span><span>(</span><span class="string-literal">&quot;N&quot;</span><span>))</span></code></pre>
            <p>In the previous example we were a bit fast-and-loose.
            Here we will be a bit more precise to illustrate the steps the computer would have to go through.
            We are trying to emulate the computer, after all.</p>
            <p>The expression containing the <code>+</code> consists of two sub-expressions, <code>1</code> and <code>(&quot;Moonage daydream&quot;.indexOf(&quot;N&quot;))</code>.
            We have to decide which to evaluate first: the left or the right.
            Let&#39;s arbitrarily choose the right sub-expression (we&#39;ll return to this choice later.)</p>
            <p>The sub-expression <code>(&quot;Moonage daydream&quot;.indexOf(&quot;N&quot;))</code> again consists of two sub-expressions, <code>&quot;Moonage daydream&quot;</code> and <code>&quot;N&quot;</code>.
            Let&#39;s again evaluate the right-hand first, remembering that literal expressions are not values so they must be evaluated.</p>
            <p>The literal <code>&quot;N&quot;</code> evaluates to the value <code>&quot;N&quot;</code>.
            To avoid this confusion let&#39;s write the value as <code>|&quot;N&quot;|</code>.
            Now we can substitute the value for the expression given in our first steps</p>
            <pre><code class="nohighlight"><span class="number-literal">1</span><span> + (</span><span class="string-literal">&quot;Moonage daydream&quot;</span><span>.</span><span class="identifier">indexOf</span><span>(|</span><span class="string-literal">&quot;N&quot;</span><span>|))</span></code></pre>
            <p>Now we can evaluate the left-hand side of the sub-expression, substituting the literal expression <code>&quot;Moonage daydream&quot;</code> with its value <code>|&quot;Moonage daydream&quot;|</code>.
            This gives us</p>
            <pre><code class="nohighlight"><span class="number-literal">1</span><span> + (|</span><span class="string-literal">&quot;Moonage daydream&quot;</span><span>|.</span><span class="identifier">indexOf</span><span>(|</span><span class="string-literal">&quot;N&quot;</span><span>|))</span></code></pre>
            <p>Now we&#39;re in a position to evaluate the entire expression <code>(|&quot;Moonage daydream&quot;|.indexOf(|&quot;N&quot;|))</code>, which evaluates to <code>|-1|</code> (again differentiating the integer value from the literal expression by using a vertical bar).
            Once again we perform substitution and now we have</p>
            <pre><code class="nohighlight"><span class="number-literal">1</span><span> + |-</span><span class="number-literal">1</span><span>|</span></code></pre>
            <p>Now we should evaluate the left-hand side literal <code>1</code>, giving <code>|1|</code>.
            Perform substitution and we get</p>
            <pre><code class="nohighlight"><span>|</span><span class="number-literal">1</span><span>| + |-</span><span class="number-literal">1</span><span>|</span></code></pre>
            <p>Now we can evaluate the entire expression, giving</p>
            <pre><code class="nohighlight"><span>|</span><span class="number-literal">0</span><span>|</span></code></pre>
            <p>We can ask Scala to evaluate the whole expression to check our work.</p>
            <pre><code class="nohighlight"><span class="number-literal">1</span><span> + (</span><span class="string-literal">&quot;Moonage daydream&quot;</span><span>.</span><span class="identifier">indexOf</span><span>(</span><span class="string-literal">&quot;N&quot;</span><span>))
</span><span class="comment">// res4: Int = 0</span></code></pre>
            <p>Correct!</p>
            <p>There are some observations we might make at this point:</p>
            <ul>
              <li>doing substitution rigorously like a computer might involve a lot of steps;</li>
            </ul>
            <ul>
              <li>the shortcut evaluation you probably did in your head probably got to the correct answer; and</li>
            </ul>
            <ul>
              <li>our seemingly arbitrary choice to do evaluation from right-to-left got us the correct answer.</li>
            </ul>
            <p>Did we somehow manage to choose the same substitution order that Scala uses (no we didn&#39;t, but we haven&#39;t investigated this yet) or does it not really matter what order we choose?
            When exactly can we take shortcuts and still reach the right result, like we did in the first example with addition?
            We will investigate these questions in just a moment, but first let&#39;s talk about how substitution works with names.</p>
            
            <h3 id="names" class="section">Names</h3>
            <p>The substitution rule for names is to substitute the name with the value it refers to.
            We&#39;ve already been using this rule implicitly.
            Now we&#39;re just formalising it.</p>
            <p>For example, given the code</p>
            <pre><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">name</span><span> = </span><span class="string-literal">&quot;Ada&quot;</span><span>
</span><span class="identifier">name</span><span> ++ </span><span class="string-literal">&quot; &quot;</span><span> ++ </span><span class="string-literal">&quot;Lovelace&quot;</span></code></pre>
            <p>we can apply substitution to get</p>
            <pre><code class="nohighlight"><span class="string-literal">&quot;Ada&quot;</span><span> ++ </span><span class="string-literal">&quot; &quot;</span><span> ++ </span><span class="string-literal">&quot;Lovelace&quot;</span></code></pre>
            <p>which evaluates to</p>
            <pre><code class="nohighlight"><span class="string-literal">&quot;Ada Lovelace&quot;</span></code></pre>
            <p>We can use names to be a bit more formal with our substitution process.
            Returning to our first example</p>
            <pre><code class="nohighlight"><span class="number-literal">1</span><span> + </span><span class="number-literal">1</span></code></pre>
            <p>we can give this expression a name:</p>
            <pre><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">two</span><span> = </span><span class="number-literal">1</span><span> + </span><span class="number-literal">1</span></code></pre>
            <p>When we see a compound expression such as</p>
            <pre><code class="nohighlight"><span>(</span><span class="number-literal">1</span><span> + </span><span class="number-literal">1</span><span>) + (</span><span class="number-literal">1</span><span> + </span><span class="number-literal">1</span><span>)</span></code></pre>
            <p>substitution tells us we can substitute <code>two</code> for <code>1 + 1</code> giving</p>
            <pre><code class="nohighlight"><span class="identifier">two</span><span> + </span><span class="identifier">two</span></code></pre>
            <p>Remember when we worked through the expression</p>
            <pre><code class="nohighlight"><span class="number-literal">1</span><span> + (</span><span class="string-literal">&quot;Moonage daydream&quot;</span><span>.</span><span class="identifier">indexOf</span><span>(</span><span class="string-literal">&quot;N&quot;</span><span>))</span></code></pre>
            <p>we broke it into sub-expressions which we then evaluated and substituted.
            Using words, this was quite convoluted.
            With a few <code>val</code> declarations we can make this both more compact and easier to see.
            Here&#39;s the same expression broken into it&#39;s components.</p>
            <pre><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">a</span><span> = </span><span class="number-literal">1</span><span>
</span><span class="keyword">val</span><span> </span><span class="identifier">b</span><span> = </span><span class="string-literal">&quot;Moonage daydream&quot;</span><span>
</span><span class="keyword">val</span><span> </span><span class="identifier">c</span><span> = </span><span class="string-literal">&quot;N&quot;</span><span>
</span><span class="keyword">val</span><span> </span><span class="identifier">d</span><span> = </span><span class="identifier">b</span><span>.</span><span class="identifier">indexOf</span><span>(</span><span class="identifier">c</span><span>)
</span><span class="keyword">val</span><span> </span><span class="identifier">e</span><span> = </span><span class="identifier">a</span><span> + </span><span class="identifier">d</span></code></pre>
            <p>If we (at this point, arbitrarily) define that evaluation occurs from top-to-bottom we can experiment with different ordering to see what difference they make.</p>
            <p>For example,</p>
            <pre><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">c</span><span> = </span><span class="string-literal">&quot;N&quot;</span><span>
</span><span class="keyword">val</span><span> </span><span class="identifier">b</span><span> = </span><span class="string-literal">&quot;Moonage daydream&quot;</span><span>
</span><span class="keyword">val</span><span> </span><span class="identifier">a</span><span> = </span><span class="number-literal">1</span><span>
</span><span class="keyword">val</span><span> </span><span class="identifier">d</span><span> = </span><span class="identifier">b</span><span>.</span><span class="identifier">indexOf</span><span>(</span><span class="identifier">c</span><span>)
</span><span class="keyword">val</span><span> </span><span class="identifier">e</span><span> = </span><span class="identifier">a</span><span> + </span><span class="identifier">d</span></code></pre>
            <p>achieves the same result as before.
            However we can&#39;t use</p>
            <pre><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">e</span><span> = </span><span class="identifier">a</span><span> + </span><span class="identifier">d</span><span>
</span><span class="keyword">val</span><span> </span><span class="identifier">a</span><span> = </span><span class="number-literal">1</span><span>
</span><span class="keyword">val</span><span> </span><span class="identifier">b</span><span> = </span><span class="string-literal">&quot;Moonage daydream&quot;</span><span>
</span><span class="keyword">val</span><span> </span><span class="identifier">c</span><span> = </span><span class="string-literal">&quot;N&quot;</span><span>
</span><span class="keyword">val</span><span> </span><span class="identifier">d</span><span> = </span><span class="identifier">b</span><span>.</span><span class="identifier">indexOf</span><span>(</span><span class="identifier">c</span><span>)</span></code></pre>
            <p>because <code>e</code> depends on <code>a</code> and <code>d</code>, and in our top-to-bottom ordering <code>a</code> and <code>d</code> have yet to be evaluated.
            We might rightly claim that this is a bit silly to even attempt. The complete expression we&#39;re trying to evaluate is  <code>e</code> but <code>a</code> to <code>d</code> are sub-expressions of <code>e</code>, so of course we have to evaluate the sub-expressions before we evaluate the expression.</p>
            <div class="flex flex-row justify-between">
                <a class="pageNavigation" href="index.html">←The Substitution Model of Evaluation</a> <a class="pageNavigation" href="order.html">Order of Evaluation→</a>
            </div>
        </main>
        <footer>Creative Scala is copyright Noel Welsh</footer>
    </div>

    </div>
</body>

</html>
