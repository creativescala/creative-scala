<!doctype html>
<html lang="">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Laika 0.19.0" />
    <title>Epicycles</title>
    
    
    <meta name="description" content="book" />
    
    <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400|Source+Sans+Pro:300,400,600"
        rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Crimson+Pro:400" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="../creative-scala.css" />
    <script src="../solution.js"></script>
    <script src="../toc.js"></script>
    <script src="../main.js"></script>
    <script> /* for avoiding page load transitions */</script>
</head>

<body>
    <nav id="topbar"><p><a href="interpolation.html">←</a></p>
<p><a href="../../">Creative Scala: Form and Function</a></p>
<p><a href="sketching.html">→</a></p></nav>
    <nav id="sidebar">
        <ul class="nav-list">
          <li class="level1 nav-leaf"><a href="../">Creative Scala: Form and Function</a></li>
          <li class="level1 nav-leaf"><a href="../foreword-1.html">Foreword to the First Edition</a></li>
          <li class="level1 nav-leaf"><a href="../foreword-2.html">Foreword to the Second Edition</a></li>
          <li class="level1 nav-node"><a href="../setup/">Getting Started</a></li>
          <li class="level2 nav-leaf"><a href="../setup/background.html">Background</a></li>
          <li class="level2 nav-leaf"><a href="../setup/terminal.html">Installing Terminal Software and a Text Editor</a></li>
          <li class="level2 nav-leaf"><a href="../setup/github.html">GitHub</a></li>
          <li class="level2 nav-leaf"><a href="../setup/intellij.html">IntelliJ</a></li>
          <li class="level2 nav-leaf"><a href="../setup/">Setup</a></li>
          <li class="level1 nav-node"><a href="../expressions/">Expressions, Values, and Types</a></li>
          <li class="level2 nav-leaf"><a href="../expressions/02-starting.html">Starting to Program</a></li>
          <li class="level2 nav-leaf"><a href="../expressions/03-expressions.html">Expressions and Values</a></li>
          <li class="level2 nav-leaf"><a href="../expressions/04-types.html">Types</a></li>
          <li class="level2 nav-leaf"><a href="../expressions/05-exercises.html">Exercises</a></li>
          <li class="level2 nav-leaf"><a href="../expressions/06-summary.html">Summary</a></li>
          <li class="level1 nav-node"><a href="../expanding-expressions/">Expanding Expressions</a></li>
          <li class="level2 nav-leaf"><a href="../expanding-expressions/02-literals.html">Literal Expressions</a></li>
          <li class="level2 nav-leaf"><a href="../expanding-expressions/03-objects.html">Values are Objects</a></li>
          <li class="level2 nav-leaf"><a href="../expanding-expressions/04-types.html">Types</a></li>
          <li class="level2 nav-leaf"><a href="../expanding-expressions/04-images.html">Images</a></li>
          <li class="level2 nav-leaf"><a href="../expanding-expressions/exercises.html">Exercises</a></li>
          <li class="level1 nav-node"><a href="../expressive-expressions/">Expressive Expressions</a></li>
          <li class="level2 nav-leaf"><a href="../expressive-expressions/02-layout.html">Layout</a></li>
          <li class="level2 nav-leaf"><a href="../expressive-expressions/03-color.html">Color</a></li>
          <li class="level2 nav-leaf"><a href="../expressive-expressions/04-creating-color.html">Creating Colors</a></li>
          <li class="level1 nav-node"><a href="../programs/">Writing Larger Programs</a></li>
          <li class="level2 nav-leaf"><a href="../programs/console.html">Working Within the Console</a></li>
          <li class="level2 nav-leaf"><a href="../programs/outside-console.html">Working Without Worksheets</a></li>
          <li class="level2 nav-leaf"><a href="../programs/names.html">Names</a></li>
          <li class="level2 nav-leaf"><a href="../programs/abstraction.html">Abstraction</a></li>
          <li class="level2 nav-leaf"><a href="../programs/imports.html">Packages and Imports</a></li>
          <li class="level1 nav-node"><a href="../substitution/">The Substitution Model of Evaluation</a></li>
          <li class="level2 nav-leaf"><a href="../substitution/substitution.html">Substitution</a></li>
          <li class="level2 nav-leaf"><a href="../substitution/order.html">Order of Evaluation</a></li>
          <li class="level2 nav-leaf"><a href="../substitution/local-reasoning.html">Local Reasoning</a></li>
          <li class="level1 nav-node"><a href="../methods/">Methods without Madness</a></li>
          <li class="level2 nav-leaf"><a href="../methods/methods.html">Methods</a></li>
          <li class="level2 nav-leaf"><a href="../methods/syntax.html">Method Syntax</a></li>
          <li class="level2 nav-leaf"><a href="../methods/semantics.html">Method Semantics</a></li>
          <li class="level2 nav-leaf"><a href="../methods/writing-methods.html">Writing Methods</a></li>
          <li class="level2 nav-leaf"><a href="../methods/conclusions.html">Conclusions</a></li>
          <li class="level1 nav-node"><a href="../recursion/">Structural Recursion over the Natural Numbers</a></li>
          <li class="level2 nav-leaf"><a href="../recursion/boxes.html">A Line of Boxes</a></li>
          <li class="level2 nav-leaf"><a href="../recursion/natural-numbers.html">The Natural Numbers</a></li>
          <li class="level2 nav-leaf"><a href="../recursion/match.html">Match Expressions</a></li>
          <li class="level2 nav-leaf"><a href="../recursion/substitution.html">Reasoning about Recursion</a></li>
          <li class="level2 nav-leaf"><a href="../recursion/conclusions.html">Conclusions</a></li>
          <li class="level1 nav-node"><a href="../fractals/">Fractals</a></li>
          <li class="level2 nav-leaf"><a href="../fractals/fractals.html">The Chessboard</a></li>
          <li class="level2 nav-leaf"><a href="../fractals/nested-methods.html">Nested Methods</a></li>
          <li class="level2 nav-leaf"><a href="../fractals/auxillary-parameter.html">Auxiliary Parameters</a></li>
          <li class="level2 nav-leaf"><a href="../fractals/exercises.html">Exercises</a></li>
          <li class="level1 nav-node"><a href="../polygons/">Points, Paths, and Polygons</a></li>
          <li class="level2 nav-leaf"><a href="../polygons/02-polar.html">Polar Coordinates</a></li>
          <li class="level2 nav-leaf"><a href="../polygons/03-path.html">Paths</a></li>
          <li class="level2 nav-leaf"><a href="../polygons/04-creative.html">Going Further</a></li>
          <li class="level2 nav-leaf"><a href="../polygons/05-conclusions.html">Conclusions</a></li>
          <li class="level1 nav-node"><a href="../flowers/">Functions and Flowers</a></li>
          <li class="level2 nav-leaf"><a href="../flowers/functions.html">Functions as Abstractions</a></li>
          <li class="level2 nav-leaf"><a href="../flowers/fun.html">Fun with Functions</a></li>
          <li class="level2 nav-leaf"><a href="../flowers/parametric-curves.html">Parametric Curves</a></li>
          <li class="level2 nav-leaf"><a href="../flowers/flowers.html">Flowers and Other Curves</a></li>
          <li class="level2 nav-leaf"><a href="../flowers/conclusions.html">Conclusions</a></li>
          <li class="level1 nav-node"><a href="index.html">Composition and Cycles</a></li>
          <li class="level2 nav-leaf"><a href="composition.html">Function Composition</a></li>
          <li class="level2 nav-leaf"><a href="fun.html">Fun with Composition</a></li>
          <li class="level2 nav-leaf"><a href="interpolation.html">Interpolation</a></li>
          <li class="level2 active nav-leaf"><a href="#">Epicycles</a></li>
          <li class="level2 nav-leaf"><a href="sketching.html">Sketching</a></li>
          <li class="level2 nav-leaf"><a href="conclusions.html">Conclusions</a></li>
          <li class="level1 nav-header">generative</li>
          <li class="level2 nav-leaf"><a href="../generative/flatmap.html">Combining Random Values</a></li>
          <li class="level2 nav-leaf"><a href="../generative/for.html">For Comprehensions</a></li>
          <li class="level2 nav-leaf"><a href="../generative/exercises.html">Exercises</a></li>
          <li class="level2 nav-leaf"><a href="../generative/">Composition of Generative Art</a></li>
          <li class="level2 nav-leaf"><a href="../generative/product.html">Combining Random Values</a></li>
          <li class="level2 nav-leaf"><a href="../generative/generative.html">Generative Art</a></li>
          <li class="level2 nav-leaf"><a href="../generative/api.html">Exploring Random</a></li>
          <li class="level2 nav-leaf"><a href="../generative/random.html">Randomness without Effect</a></li>
          <li class="level1 nav-header">animation</li>
          <li class="level2 nav-leaf"><a href="../animation/">Animation and Fireworks</a></li>
          <li class="level2 nav-leaf"><a href="../animation/easing.html">Easing Functions</a></li>
          <li class="level2 nav-leaf"><a href="../animation/reactor.html">Reactors</a></li>
          <li class="level1 nav-leaf"><a href="../solutions.html">Solutions to Exercises {#solutions}</a></li>
          <li class="level1 nav-header">quickreference</li>
          <li class="level2 nav-leaf"><a href="../quickreference/">Syntax Quick Reference {#syntax-quick-reference}</a></li>
          <li class="level1 nav-header">collections</li>
          <li class="level2 nav-leaf"><a href="../collections/transform.html">Transforming Sequences</a></li>
          <li class="level2 nav-leaf"><a href="../collections/create.html">Creating Sequences</a></li>
          <li class="level2 nav-leaf"><a href="../collections/">Collections {#collections}</a></li>
          <li class="level2 nav-leaf"><a href="../collections/take-home-points.html">Take Home Points</a></li>
          <li class="level2 nav-leaf"><a href="../collections/paths.html">Drawing Paths</a></li>
          <li class="level1 nav-header">data</li>
          <li class="level2 nav-leaf"><a href="../data/data.html">Data</a></li>
          <li class="level2 nav-leaf"><a href="../data/case-classes.html">Case Classes</a></li>
          <li class="level2 nav-leaf"><a href="../data/">Creating and Working With Data</a></li>
          <li class="level1 nav-header">declarations</li>
          <li class="level2 nav-leaf"><a href="../declarations/color-palette.html">Extended Exercise: Color Palettes</a></li>
          <li class="level2 nav-leaf"><a href="../declarations/value-declarations.html">Value Declarations</a></li>
          <li class="level2 nav-leaf"><a href="../declarations/method-declarations.html">Method Declarations</a></li>
          <li class="level2 nav-leaf"><a href="../declarations/">Declarations</a></li>
          <li class="level2 nav-leaf"><a href="../declarations/take-home-points.html">Take Home Points</a></li>
          <li class="level1 nav-header">turtles</li>
          <li class="level2 nav-leaf"><a href="../turtles/turtles.html">Controlling the Turtle</a></li>
          <li class="level2 nav-leaf"><a href="../turtles/exercises.html">Exercises</a></li>
          <li class="level2 nav-leaf"><a href="../turtles/">Turtle Algebra and Algebraic Data Types</a></li>
          <li class="level2 nav-leaf"><a href="../turtles/branching.html">Branching Structures</a></li>
          <li class="level1 nav-header">adt</li>
          <li class="level2 nav-leaf"><a href="../adt/">Algebraic Data Types To Call Our Own</a></li>
          <li class="level2 nav-leaf"><a href="../adt/turtle.html">Build Your Own Turtle</a></li>
          <li class="level2 nav-leaf"><a href="../adt/adt.html">Algebraic Data Types</a></li>
          <li class="level1 nav-header">fp</li>
          <li class="level2 nav-leaf"><a href="../fp/recursion.html">Recursive Algorithms</a></li>
          <li class="level2 nav-leaf"><a href="../fp/">(Functional) Programming</a></li>
          <li class="level2 nav-leaf"><a href="../fp/take-home-points.html">Take Home Points</a></li>
          <li class="level2 nav-leaf"><a href="../fp/functions.html">Functions as Values</a></li>
          <li class="level1 nav-leaf"><a href="../intro.html">Introduction</a></li>
          <li class="level1 nav-header">summary</li>
          <li class="level2 nav-leaf"><a href="../summary/">Summary</a></li>
          <li class="level1 nav-header">sequences</li>
          <li class="level2 nav-leaf"><a href="../sequences/lists.html">Working with Lists</a></li>
          <li class="level2 nav-leaf"><a href="../sequences/">Shapes, Sequences, and Stars</a></li>
          <li class="level2 nav-leaf"><a href="../sequences/map.html">Transforming Sequences</a></li>
          <li class="level2 nav-leaf"><a href="../sequences/stars.html">My God, It&#39;s Full of Stars!</a></li>
          <li class="level2 nav-leaf"><a href="../sequences/paths.html">Paths</a></li>
          <li class="level1 nav-leaf"><a href="../links.html">links.md</a></li>
        </ul>
    </nav>

    <div id="content">
        <main class="content">
            <h1 id="epicycles" class="title">Epicycles</h1>
            <p>We&#39;re now going to see a different example of composition, in creating a type of curve known as an epicycle. 
            An epicycle is produced when we trace a point on a circle rotating on another circle. 
            We can stack circles on top of circles, and change the speed at which they rotate, to produce many different curves. 
            Here&#39;s an example using two circles.</p>
            <div class="doodle" id="epicycle"></div>
            <script>CyclesEpicycles.epicycleTwoWheels("epicycle")</script>
            <p>The parametric curve that produces this result is</p>
            <pre><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">twoWheels</span><span>: </span><span class="type-name">Angle</span><span> =&gt; </span><span class="type-name">Point</span><span> =
  (</span><span class="identifier">angle</span><span>: </span><span class="type-name">Angle</span><span>) =&gt;
    </span><span class="type-name">Point</span><span>(</span><span class="number-literal">75</span><span>, </span><span class="identifier">angle</span><span> * </span><span class="number-literal">6</span><span>) + </span><span class="type-name">Point</span><span>(</span><span class="number-literal">32</span><span>, </span><span class="identifier">angle</span><span> * </span><span class="number-literal">11</span><span>).</span><span class="identifier">toVec</span></code></pre>
            <p>Let&#39;s walk through this code. We know that a parametric circle is</p>
            <pre><code class="nohighlight"><span>(</span><span class="identifier">angle</span><span>: </span><span class="type-name">Angle</span><span>) =&gt; </span><span class="type-name">Point</span><span>(</span><span class="number-literal">1.0</span><span>, </span><span class="identifier">angle</span><span>)</span></code></pre>
            <p>where I&#39;ve chosen the radius to be 1. So</p>
            <pre><code class="nohighlight"><span>(</span><span class="identifier">angle</span><span>: </span><span class="type-name">Angle</span><span>) =&gt; </span><span class="type-name">Point</span><span>(</span><span class="number-literal">75</span><span>, </span><span class="identifier">angle</span><span> * </span><span class="number-literal">6</span><span>)</span></code></pre>
            <p>is a parametric circle with radius 75, which is spinning six times faster.
            By the same reasoning</p>
            <pre><code class="nohighlight"><span>(</span><span class="identifier">angle</span><span>: </span><span class="type-name">Angle</span><span>) =&gt; </span><span class="type-name">Point</span><span>(</span><span class="number-literal">32</span><span>, </span><span class="identifier">angle</span><span> * </span><span class="number-literal">11</span><span>)</span></code></pre>
            <p>is a parametric circle with radius 32 spinning eleven times faster.</p>
            <p>The remaining portion of the code is a conversion from <code>Point</code> to <code>Vec</code> (the call to <code>toVec</code>) and addition of a <code>Point</code> and a <code>Vec</code>. </p>
            <pre><code class="nohighlight"><span class="type-name">Point</span><span>(..., ...) + </span><span class="type-name">Point</span><span>(..., ...).</span><span class="identifier">toVec</span></code></pre>
            <p>This moves the center of the smaller circle to the current point on the larger circle. 
            The conversion from <code>Point</code> to <code>Vec</code> is needed for technical reasons which I&#39;ll attempt to briefly explain. 
            A point specifies a location relative to a fixed origin. 
            A vector represents a displacement relative to some arbitrary starting point. 
            Therefore we can add a vector to a point to get a new point that is shifted by the vector.
            Adding a point to a point, however, is not possible as points are both locations relative to the same origin, not displacements like a vector is.
            (If this explanation doesn&#39;t work for you, there are many online resources that describe vectors.)</p>
            <p>This is everything we need to build our own curves based on epicycles.
            The more circles we add, the more complex the curve we can create.
            The examples below are created using the following code. 
            It uses three circles with fixed radius, but allows us to change the speed of rotation.</p>
            <pre><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">epicycle</span><span>(</span><span class="identifier">a</span><span>: </span><span class="type-name">Int</span><span>, </span><span class="identifier">b</span><span>: </span><span class="type-name">Int</span><span>, </span><span class="identifier">c</span><span>: </span><span class="type-name">Int</span><span>): </span><span class="type-name">Angle</span><span> =&gt; </span><span class="type-name">Point</span><span> =
  (</span><span class="identifier">angle</span><span>: </span><span class="type-name">Angle</span><span>) =&gt;
    (</span><span class="type-name">Point</span><span>(</span><span class="number-literal">75</span><span>, </span><span class="identifier">angle</span><span> * </span><span class="identifier">a</span><span>).</span><span class="identifier">toVec</span><span> + </span><span class="type-name">Point</span><span>(</span><span class="number-literal">32</span><span>, </span><span class="identifier">angle</span><span> * </span><span class="identifier">b</span><span>).</span><span class="identifier">toVec</span><span> + </span><span class="type-name">Point</span><span>(</span><span class="number-literal">15</span><span>, </span><span class="identifier">angle</span><span> * </span><span class="identifier">c</span><span>).</span><span class="identifier">toVec</span><span>).</span><span class="identifier">toPoint</span></code></pre>
            <p>The examples are created by choosing the parameters a, b, c, as (1, 6, 14), (7, 13, 25), and (1, 7, -21) respectively.</p>
            <p><img src="./epicycle.svg" alt="Examples of epicycle curves, with the parameters chosen as (1, 6, 14), (7, 13, 25), and (1, 7 -21)." title="Figure Some(#fig:cycles:epicycle): caption"></p>
            
            <h2 id="composing-epicycles" class="section">Composing Epicycles</h2>
            <p>Let&#39;s return to the theme of this chapter, function composition.
            Using function composition we can do what we&#39;ve done before,
            and break the epicycle curves into small reusuable parts.</p>
            <p>The first component we need is a parametric circle that allows us to change the speed of rotation.
            I called this a <code>wheel</code>.</p>
            <pre><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">wheel</span><span>(</span><span class="identifier">speed</span><span>: </span><span class="type-name">Int</span><span>): </span><span class="type-name">Angle</span><span> =&gt; </span><span class="type-name">Point</span><span> =
  ???</span></code></pre>
            <p>We can use <code>scale</code>, which we&#39;ve already defined, to change the radius.</p>
            <p>The other component we need is a way to position a wheel relative to another wheel. 
            (This is the point / vector addition part.)
            I called this <code>on</code>.</p>
            <pre><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">on</span><span>(</span><span class="identifier">wheel1</span><span>: </span><span class="type-name">Angle</span><span> =&gt; </span><span class="type-name">Point</span><span>, </span><span class="identifier">wheel2</span><span>: </span><span class="type-name">Angle</span><span> =&gt; </span><span class="type-name">Point</span><span>): </span><span class="type-name">Angle</span><span> =&gt; </span><span class="type-name">Point</span><span> =
  ???</span></code></pre>
            <div class="exercise">
              
              <h4 id="exercise-wheels-on-wheels">Exercise: Wheels on Wheels</h4>
              <p>Implement <code>wheel</code> and <code>on</code>, described above. 
              Then use them, as well as tools we&#39;ve created earlier, to draw your own epicycle curves.</p>
            </div>
            <div class="solution">
              <div class="solution-body">
                <p><code>wheel</code> is a parametric circle that rotates at the given speed.</p>
                <pre><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">wheel</span><span>(</span><span class="identifier">speed</span><span>: </span><span class="type-name">Int</span><span>): </span><span class="type-name">Angle</span><span> =&gt; </span><span class="type-name">Point</span><span> =
  </span><span class="identifier">angle</span><span> =&gt; </span><span class="type-name">Point</span><span>(</span><span class="number-literal">1.0</span><span>, </span><span class="identifier">angle</span><span> * </span><span class="identifier">speed</span><span>)</span></code></pre>
                <p><code>on</code> implements the point and vector addition we discussed earlier.</p>
                <pre><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">on</span><span>(</span><span class="identifier">wheel1</span><span>: </span><span class="type-name">Angle</span><span> =&gt; </span><span class="type-name">Point</span><span>, </span><span class="identifier">wheel2</span><span>: </span><span class="type-name">Angle</span><span> =&gt; </span><span class="type-name">Point</span><span>): </span><span class="type-name">Angle</span><span> =&gt; </span><span class="type-name">Point</span><span> =
  </span><span class="identifier">angle</span><span> =&gt; </span><span class="identifier">wheel1</span><span>(</span><span class="identifier">angle</span><span>) + </span><span class="identifier">wheel2</span><span>(</span><span class="identifier">angle</span><span>).</span><span class="identifier">toVec</span></code></pre>
                <p>With these we can easily construct epicycle curves. 
                The example we started this section with</p>
                <pre><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">twoWheels</span><span>: </span><span class="type-name">Angle</span><span> =&gt; </span><span class="type-name">Point</span><span> =
  (</span><span class="identifier">angle</span><span>: </span><span class="type-name">Angle</span><span>) =&gt;
    </span><span class="type-name">Point</span><span>(</span><span class="number-literal">75</span><span>, </span><span class="identifier">angle</span><span> * </span><span class="number-literal">6</span><span>) + </span><span class="type-name">Point</span><span>(</span><span class="number-literal">32</span><span>, </span><span class="identifier">angle</span><span> * </span><span class="number-literal">11</span><span>).</span><span class="identifier">toVec</span></code></pre>
                <p>can be written as</p>
                <pre><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">wheel1</span><span> = </span><span class="identifier">wheel</span><span>(</span><span class="number-literal">6</span><span>).</span><span class="identifier">andThen</span><span>(</span><span class="identifier">scale</span><span>(</span><span class="number-literal">75</span><span>))
</span><span class="keyword">val</span><span> </span><span class="identifier">wheel2</span><span> = </span><span class="identifier">wheel</span><span>(</span><span class="number-literal">11</span><span>).</span><span class="identifier">andThen</span><span>(</span><span class="identifier">scale</span><span>(</span><span class="number-literal">32</span><span>))

</span><span class="keyword">val</span><span> </span><span class="identifier">combined</span><span> = </span><span class="identifier">on</span><span>(</span><span class="identifier">wheel1</span><span>, </span><span class="identifier">wheel2</span><span>)</span></code></pre>
              </div>
            </div>
            <div class="flex flex-row justify-between">
                <a class="pageNavigation" href="interpolation.html">←Interpolation</a> <a class="pageNavigation" href="sketching.html">Sketching→</a>
            </div>
        </main>
        <footer>Creative Scala is copyright Noel Welsh</footer>
    </div>

    </div>
</body>

</html>
