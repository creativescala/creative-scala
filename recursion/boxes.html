<!doctype html>
<html lang="">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Laika 0.19.0" />
    <title>A Line of Boxes</title>
    
    
    <meta name="description" content="book" />
    
    <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400|Source+Sans+Pro:300,400,600"
        rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Crimson+Pro:400" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="../creative-scala.css" />
    <script src="../solution.js"></script>
    <script src="../main.js"></script>
    <script> /* for avoiding page load transitions */</script>
</head>

<body>
    <nav id="topbar"><p><a href="index.html">←</a></p>
<p><a href="../../">Creative Scala: Form and Function</a></p>
<p><a href="natural-numbers.html">→</a></p></nav>
    <nav id="sidebar">
        <ul class="nav-list">
          <li class="level1 nav-leaf"><a href="../">Creative Scala: Form and Function</a></li>
          <li class="level1 nav-leaf"><a href="../foreword-1.html">Foreword to the First Edition</a></li>
          <li class="level1 nav-leaf"><a href="../foreword-2.html">Foreword to the Second Edition</a></li>
          <li class="level1 nav-node"><a href="../setup/">Getting Started</a></li>
          <li class="level2 nav-leaf"><a href="../setup/background.html">Background</a></li>
          <li class="level2 nav-leaf"><a href="../setup/terminal.html">Installing Terminal Software and a Text Editor</a></li>
          <li class="level2 nav-leaf"><a href="../setup/github.html">GitHub</a></li>
          <li class="level2 nav-leaf"><a href="../setup/intellij.html">IntelliJ</a></li>
          <li class="level2 nav-leaf"><a href="../setup/">Setup</a></li>
          <li class="level1 nav-node"><a href="../expressions/">Expressions, Values, and Types</a></li>
          <li class="level2 nav-leaf"><a href="../expressions/02-starting.html">Starting to Program</a></li>
          <li class="level2 nav-leaf"><a href="../expressions/03-expressions.html">Expressions and Values</a></li>
          <li class="level2 nav-leaf"><a href="../expressions/04-types.html">Types</a></li>
          <li class="level2 nav-leaf"><a href="../expressions/05-exercises.html">Exercises</a></li>
          <li class="level2 nav-leaf"><a href="../expressions/06-summary.html">Summary</a></li>
          <li class="level1 nav-node"><a href="../expanding-expressions/">Expanding Expressions</a></li>
          <li class="level2 nav-leaf"><a href="../expanding-expressions/02-literals.html">Literal Expressions</a></li>
          <li class="level2 nav-leaf"><a href="../expanding-expressions/03-objects.html">Values are Objects</a></li>
          <li class="level2 nav-leaf"><a href="../expanding-expressions/04-types.html">Types</a></li>
          <li class="level2 nav-leaf"><a href="../expanding-expressions/exercises.html">Exercises</a></li>
          <li class="level2 nav-leaf"><a href="../expanding-expressions/04-images.html">Images</a></li>
          <li class="level1 nav-node"><a href="../expressive-expressions/">Expressive Expressions</a></li>
          <li class="level2 nav-leaf"><a href="../expressive-expressions/02-layout.html">Layout</a></li>
          <li class="level2 nav-leaf"><a href="../expressive-expressions/03-color.html">Color</a></li>
          <li class="level2 nav-leaf"><a href="../expressive-expressions/04-creating-color.html">Creating Colors</a></li>
          <li class="level1 nav-header">programs</li>
          <li class="level2 nav-leaf"><a href="../programs/imports.html">Packages and Imports</a></li>
          <li class="level2 nav-leaf"><a href="../programs/outside-console.html">Coding Outside the Console</a></li>
          <li class="level2 nav-leaf"><a href="../programs/console.html">Working Within the Console</a></li>
          <li class="level2 nav-leaf"><a href="../programs/names.html">Names</a></li>
          <li class="level2 nav-leaf"><a href="../programs/">Writing Larger Programs</a></li>
          <li class="level2 nav-leaf"><a href="../programs/abstraction.html">Abstraction</a></li>
          <li class="level1 nav-node"><a href="../substitution/">The Substitution Model of Evaluation</a></li>
          <li class="level2 nav-leaf"><a href="../substitution/substitution.html">Substitution</a></li>
          <li class="level2 nav-leaf"><a href="../substitution/order.html">Order of Evaluation</a></li>
          <li class="level2 nav-leaf"><a href="../substitution/local-reasoning.html">Local Reasoning</a></li>
          <li class="level1 nav-node"><a href="../methods/">Methods without Madness</a></li>
          <li class="level2 nav-leaf"><a href="../methods/methods.html">Methods</a></li>
          <li class="level2 nav-leaf"><a href="../methods/syntax.html">Method Syntax</a></li>
          <li class="level2 nav-leaf"><a href="../methods/semantics.html">Method Semantics</a></li>
          <li class="level2 nav-leaf"><a href="../methods/writing-methods.html">Writing Methods</a></li>
          <li class="level2 nav-leaf"><a href="../methods/conclusions.html">Conclusions</a></li>
          <li class="level1 nav-node"><a href="index.html">Structural Recursion over the Natural Numbers</a></li>
          <li class="level2 active nav-leaf"><a href="#">A Line of Boxes</a></li>
          <li class="level2 nav-leaf"><a href="natural-numbers.html">The Natural Numbers</a></li>
          <li class="level2 nav-leaf"><a href="match.html">Match Expressions</a></li>
          <li class="level2 nav-leaf"><a href="substitution.html">Reasoning about Recursion</a></li>
          <li class="level2 nav-leaf"><a href="conclusions.html">Conclusions</a></li>
          <li class="level1 nav-node"><a href="../fractals/">Fractals</a></li>
          <li class="level2 nav-leaf"><a href="../fractals/fractals.html">The Chessboard</a></li>
          <li class="level2 nav-leaf"><a href="../fractals/nested-methods.html">Nested Methods</a></li>
          <li class="level2 nav-leaf"><a href="../fractals/auxillary-parameter.html">Auxiliary Parameters</a></li>
          <li class="level2 nav-leaf"><a href="../fractals/exercises.html">Exercises</a></li>
          <li class="level1 nav-node"><a href="../polygons/">Points, Paths, and Polygons</a></li>
          <li class="level2 nav-leaf"><a href="../polygons/02-polar.html">Polar Coordinates</a></li>
          <li class="level2 nav-leaf"><a href="../polygons/03-path.html">Paths</a></li>
          <li class="level2 nav-leaf"><a href="../polygons/04-creative.html">Going Further</a></li>
          <li class="level2 nav-leaf"><a href="../polygons/05-conclusions.html">Conclusions</a></li>
          <li class="level1 nav-node"><a href="../flowers/">Functions and Flowers</a></li>
          <li class="level2 nav-leaf"><a href="../flowers/functions.html">Functions as Abstractions</a></li>
          <li class="level2 nav-leaf"><a href="../flowers/fun.html">Fun with Functions</a></li>
          <li class="level2 nav-leaf"><a href="../flowers/parametric-curves.html">Parametric Curves</a></li>
          <li class="level2 nav-leaf"><a href="../flowers/flowers.html">Flowers and Other Curves</a></li>
          <li class="level2 nav-leaf"><a href="../flowers/conclusions.html">Conclusions</a></li>
          <li class="level1 nav-node"><a href="../cycles/">Composition and Cycles</a></li>
          <li class="level2 nav-leaf"><a href="../cycles/composition.html">Function Composition</a></li>
          <li class="level2 nav-leaf"><a href="../cycles/epicycloids.html">Epicycloids</a></li>
          <li class="level1 nav-header">collections</li>
          <li class="level2 nav-leaf"><a href="../collections/create.html">Creating Sequences</a></li>
          <li class="level2 nav-leaf"><a href="../collections/take-home-points.html">Take Home Points</a></li>
          <li class="level2 nav-leaf"><a href="../collections/">Collections {#collections}</a></li>
          <li class="level2 nav-leaf"><a href="../collections/transform.html">Transforming Sequences</a></li>
          <li class="level2 nav-leaf"><a href="../collections/paths.html">Drawing Paths</a></li>
          <li class="level1 nav-header">generative</li>
          <li class="level2 nav-leaf"><a href="../generative/generative.html">Generative Art</a></li>
          <li class="level2 nav-leaf"><a href="../generative/random.html">Randomness without Effect</a></li>
          <li class="level2 nav-leaf"><a href="../generative/api.html">Exploring Random</a></li>
          <li class="level2 nav-leaf"><a href="../generative/exercises.html">Exercises</a></li>
          <li class="level2 nav-leaf"><a href="../generative/for.html">For Comprehensions</a></li>
          <li class="level2 nav-leaf"><a href="../generative/product.html">Combining Random Values</a></li>
          <li class="level2 nav-leaf"><a href="../generative/">Composition of Generative Art</a></li>
          <li class="level2 nav-leaf"><a href="../generative/flatmap.html">Combining Random Values</a></li>
          <li class="level1 nav-header">quickreference</li>
          <li class="level2 nav-leaf"><a href="../quickreference/">Syntax Quick Reference {#syntax-quick-reference}</a></li>
          <li class="level1 nav-leaf"><a href="../solutions.html">Solutions to Exercises {#solutions}</a></li>
          <li class="level1 nav-header">fp</li>
          <li class="level2 nav-leaf"><a href="../fp/recursion.html">Recursive Algorithms</a></li>
          <li class="level2 nav-leaf"><a href="../fp/take-home-points.html">Take Home Points</a></li>
          <li class="level2 nav-leaf"><a href="../fp/functions.html">Functions as Values</a></li>
          <li class="level2 nav-leaf"><a href="../fp/">(Functional) Programming</a></li>
          <li class="level1 nav-header">summary</li>
          <li class="level2 nav-leaf"><a href="../summary/">Summary</a></li>
          <li class="level1 nav-header">sequences</li>
          <li class="level2 nav-leaf"><a href="../sequences/lists.html">Working with Lists</a></li>
          <li class="level2 nav-leaf"><a href="../sequences/stars.html">My God, It&#39;s Full of Stars!</a></li>
          <li class="level2 nav-leaf"><a href="../sequences/">Shapes, Sequences, and Stars</a></li>
          <li class="level2 nav-leaf"><a href="../sequences/map.html">Transforming Sequences</a></li>
          <li class="level2 nav-leaf"><a href="../sequences/paths.html">Paths</a></li>
          <li class="level1 nav-header">animation</li>
          <li class="level2 nav-leaf"><a href="../animation/reactor.html">Reactors</a></li>
          <li class="level2 nav-leaf"><a href="../animation/easing.html">Easing Functions</a></li>
          <li class="level2 nav-leaf"><a href="../animation/">Animation and Fireworks</a></li>
          <li class="level1 nav-header">turtles</li>
          <li class="level2 nav-leaf"><a href="../turtles/branching.html">Branching Structures</a></li>
          <li class="level2 nav-leaf"><a href="../turtles/turtles.html">Controlling the Turtle</a></li>
          <li class="level2 nav-leaf"><a href="../turtles/exercises.html">Exercises</a></li>
          <li class="level2 nav-leaf"><a href="../turtles/">Turtle Algebra and Algebraic Data Types</a></li>
          <li class="level1 nav-leaf"><a href="../intro.html">Introduction</a></li>
          <li class="level1 nav-header">adt</li>
          <li class="level2 nav-leaf"><a href="../adt/adt.html">Algebraic Data Types</a></li>
          <li class="level2 nav-leaf"><a href="../adt/turtle.html">Build Your Own Turtle</a></li>
          <li class="level2 nav-leaf"><a href="../adt/">Algebraic Data Types To Call Our Own</a></li>
          <li class="level1 nav-header">data</li>
          <li class="level2 nav-leaf"><a href="../data/case-classes.html">Case Classes</a></li>
          <li class="level2 nav-leaf"><a href="../data/data.html">Data</a></li>
          <li class="level2 nav-leaf"><a href="../data/">Creating and Working With Data</a></li>
          <li class="level1 nav-header">declarations</li>
          <li class="level2 nav-leaf"><a href="../declarations/method-declarations.html">Method Declarations</a></li>
          <li class="level2 nav-leaf"><a href="../declarations/color-palette.html">Extended Exercise: Color Palettes</a></li>
          <li class="level2 nav-leaf"><a href="../declarations/take-home-points.html">Take Home Points</a></li>
          <li class="level2 nav-leaf"><a href="../declarations/value-declarations.html">Value Declarations</a></li>
          <li class="level2 nav-leaf"><a href="../declarations/">Declarations</a></li>
          <li class="level1 nav-leaf"><a href="../links.html">links.md</a></li>
        </ul>
    </nav>

    <div id="content">
        <main class="content">
            <h1 id="a-line-of-boxes" class="title">A Line of Boxes</h1>
            <p>Let&#39;s start with an example, drawing a line or row of boxes as in Figure recursion:sequential-boxes.</p>
            <p><img src="./src/pages/recursion/sequential-boxes.pdf+svg" alt="Five boxes filled with Royal Blue" title="Figure Some(#fig:recursion:sequential-boxes): caption"></p>
            <p>Let&#39;s define a box to begin with.</p>
            <pre><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">aBox</span><span> = </span><span class="type-name">Image</span><span>.</span><span class="identifier">square</span><span>(</span><span class="number-literal">20</span><span>).</span><span class="identifier">fillColor</span><span>(</span><span class="type-name">Color</span><span>.</span><span class="identifier">royalBlue</span><span>)</span></code></pre>
            <p>Then one box in a row is just</p>
            <pre><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">oneBox</span><span> = </span><span class="identifier">aBox</span></code></pre>
            <p>If we want to have two boxes side by side, that is easy enough.</p>
            <pre><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">twoBoxes</span><span> = </span><span class="identifier">aBox</span><span>.</span><span class="identifier">beside</span><span>(</span><span class="identifier">oneBox</span><span>)</span></code></pre>
            <p>Similarly for three.</p>
            <pre><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">threeBoxes</span><span> = </span><span class="identifier">aBox</span><span>.</span><span class="identifier">beside</span><span>(</span><span class="identifier">twoBoxes</span><span>)</span></code></pre>
            <p>And so on for as many boxes as we care to create.</p>
            <p>You might think this is an unusual way to create these images.
            Why not just write something like this, for example?</p>
            <pre><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">threeBoxes</span><span> = </span><span class="identifier">aBox</span><span>.</span><span class="identifier">beside</span><span>(</span><span class="identifier">aBox</span><span>).</span><span class="identifier">beside</span><span>(</span><span class="identifier">aBox</span><span>)</span></code></pre>
            <p>These two definitions are equivalent, as we can see from substitution.
            We&#39;ve chosen to write later images in terms of earlier ones to emphasise the structure we&#39;re dealing with, which is building up to structural recursion.</p>
            <p>Writing images in this way could get very tedious.
            What we&#39;d really like is some way to tell the computer the number of boxes we&#39;d like.
            More technically, we would like to abstract over the expressions above.
            We learned in the previous chapter that methods abstract over expressions, so let&#39;s try to write a method to solve this problem.</p>
            <p>We&#39;ll start by writing a method skeleton that defines, as usual, what goes into the method and what it evaluates to.
            In this case we supply an <code>Int</code> <code>count</code>, which is the number of boxes we want, and we get back an <code>Image</code>.</p>
            <pre><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">boxes</span><span>(</span><span class="identifier">count</span><span>: </span><span class="type-name">Int</span><span>): </span><span class="type-name">Image</span><span> =
  ???</span></code></pre>
            <p>Now comes the new part, the <em>structural recursion</em>.
            We noticed that <code>threeBoxes</code> above is defined in terms of <code>twoBoxes</code>, and <code>twoBoxes</code> is itself defined in terms of <code>box</code>.
            We could even define <code>box</code> in terms of <em>no</em> boxes, like so:</p>
            <pre><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">oneBox</span><span> = </span><span class="identifier">aBox</span><span>.</span><span class="identifier">beside</span><span>(</span><span class="type-name">Image</span><span>.</span><span class="identifier">empty</span><span>)</span></code></pre>
            <p>Here we used <code>Image.empty</code> to represent no boxes.</p>
            <p>Imagine we had already implemented the <code>boxes</code> method.
            We can say the following properties of <code>boxes</code> always hold, if it is correctly implemented:</p>
            <ul>
              <li><code>boxes(0) == Image.empty</code></li>
              <li><code>boxes(1) == aBox.beside(boxes(0))</code></li>
              <li><code>boxes(2) == aBox.beside(boxes(1))</code></li>
              <li><code>boxes(3) == aBox.beside(boxes(2))</code></li>
            </ul>
            <p>The last three properties all have the same general shape.
            We can describe all of them, and any case for <code>n &gt; 0</code>, with the single property <code>boxes(n) == aBox.beside(boxes(n - 1))</code>.
            So we&#39;re left with two properties</p>
            <ul>
              <li><code>boxes(0) == Image.empty</code></li>
              <li><code>boxes(n) == aBox.beside(boxes(n-1))</code></li>
            </ul>
            <p>These two properties completely define the behavior of <code>boxes</code>.
            In fact we can implement <code>boxes</code> by converting these properties into code.</p>
            <p>A full implementation of <code>boxes</code> is</p>
            <pre><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">boxes</span><span>(</span><span class="identifier">count</span><span>: </span><span class="type-name">Int</span><span>): </span><span class="type-name">Image</span><span> =
  </span><span class="identifier">count</span><span> </span><span class="keyword">match</span><span> {
    </span><span class="keyword">case</span><span> </span><span class="number-literal">0</span><span> =&gt; </span><span class="type-name">Image</span><span>.</span><span class="identifier">empty</span><span>
    </span><span class="keyword">case</span><span> </span><span class="identifier">n</span><span> =&gt; </span><span class="identifier">aBox</span><span>.</span><span class="identifier">beside</span><span>(</span><span class="identifier">boxes</span><span>(</span><span class="identifier">n</span><span>-</span><span class="number-literal">1</span><span>))
  }</span></code></pre>
            <p>Try it and see what results you get!
            This implementation is only tiny bit more verbose than the properties we wrote above, and is our first structural recursion over the natural numbers.</p>
            <p>At this point we have two questions to answer.
            Firstly, how does this <code>match</code> expression work?
            More importantly, is there some general principle we can use to create methods like this on our own?
            Let&#39;s take each question in turn.</p>
            
            <h3 id="exercise-stacking-boxes" class="section">Exercise: Stacking Boxes {-}</h3>
            <p>Even before we get into the details of <code>match</code> expressions you should be able to modify <code>boxes</code> to produce an image like Figure recursion:stacked-boxes.</p>
            <p>At this point we&#39;re trying to get used to the syntax of <code>match</code>, so rather than copying and pasting <code>boxes</code> write it all out by hand again to get some practice.</p>
            <p><img src="./src/pages/recursion/sequential-boxes.pdf+svg" alt="Three stacked boxes filled with Royal Blue" title="Figure Some(#fig:recursion:stacked-boxes): caption"></p>
            <p>&lt;div class=&quot;solution&quot;&gt;
            All you to do is change <code>beside</code> to <code>above</code> in <code>boxes</code>.</p>
            <pre><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">stackedBoxes</span><span>(</span><span class="identifier">count</span><span>: </span><span class="type-name">Int</span><span>): </span><span class="type-name">Image</span><span> =
  </span><span class="identifier">count</span><span> </span><span class="keyword">match</span><span> {
    </span><span class="keyword">case</span><span> </span><span class="number-literal">0</span><span> =&gt; </span><span class="type-name">Image</span><span>.</span><span class="identifier">empty</span><span>
    </span><span class="keyword">case</span><span> </span><span class="identifier">n</span><span> =&gt; </span><span class="identifier">aBox</span><span>.</span><span class="identifier">beside</span><span>(</span><span class="identifier">stackedBoxes</span><span>(</span><span class="identifier">n</span><span>-</span><span class="number-literal">1</span><span>))
  }</span></code></pre>
            <p>&lt;/div&gt;</p>
            <div class="flex flex-row justify-between">
                <a class="pageNavigation" href="index.html">←Structural Recursion over the Natural Numbers</a> <a class="pageNavigation" href="natural-numbers.html">The Natural Numbers→</a>
            </div>
        </main>
        <footer>Creative Scala is copyright Noel Welsh</footer>
    </div>

    </div>
</body>

</html>
